# This file explains how to download and create a text file with
# the offical instlumi/pileup values for 2012 Data ordered by Run, Ls
# Official Twiki page you can check for latest info
# https://twiki.cern.ch/twiki/bin/view/CMS/LumiCalc

cd ../..
cmsenv
addpkg RecoLuminosity/LumiDB V04-01-06
scram b

# Get latest 2012 DCS JSON file
wget --no-check-certificate https://cms-service-dqm.web.cern.ch/cms-service-dqm/CAF/certification/Collisions12/8TeV/DCSOnly/json_DCSONLY.txt

# Run lumiCalc2.py script and reformat output to
# [Run] [LumiSection] [InstLumi (delivered)] [Pileup]
RecoLuminosity/LumiDB/scripts/lumiCalc2.py -i json_DCSONLY.txt lumibyls | grep "STABLE BEAMS" | awk '{ print $2" "$4" "$(NF-5)" "$(NF-1) }' | sed "s;:; ;g" | awk '{ print $1" "$3" "$5" "$6 }' >! DPGAnalysis/PixelTimingStudy/run_ls_instlumi_pileup_2012.txt
